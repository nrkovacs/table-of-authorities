<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>AutoTOA Generator</title><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><script defer="defer" src="taskpane.js"></script></head><body><div class="container"><header class="header"><h2>âš–ï¸ AutoTOA Generator</h2><p class="desc">Smart Table of Authorities with native Word field codes.</p></header><main class="content"><section class="step-section"><button id="scanButton" class="btn btn-primary">ğŸ” 1. Scan Document</button></section><div id="status" class="status hidden"><span id="statusMessage"></span></div><div id="progressContainer" class="progress-container hidden"><div class="progress-bar"><div id="progressBar" class="progress-fill"></div></div><div id="progressText" class="progress-text"></div></div><div id="stats" class="stats hidden"><h3>Citations Found</h3><div id="statsContent"></div></div><div id="citationsList" class="citations-list hidden"><h3>Review &amp; Edit Citations</h3><p class="help-text">Uncheck to exclude. Click âœï¸ to edit the Long/Short citation text before marking.</p><div id="citationsContent"></div></div><section id="markSection" class="step-section hidden"><button id="markAllButton" class="btn btn-mark">ğŸ“Œ 2. Mark All Citations (TA Fields)</button><p class="help-text">Injects native <code>{ TA }</code> fields next to each citation. Pin cites are auto-stripped for clean grouping.</p></section><section id="idSection" class="step-section hidden"><div class="id-resolver"><div class="id-status"><strong>Last Marked:</strong> <span id="lastMarkedCite" class="last-marked">â€”</span></div><button id="markIdButton" class="btn btn-id">ğŸ“ Mark Selection as "Id."</button><p class="help-text">Select an <em>Id.</em> reference in the document, then click to inject a <code>{ TA \s }</code> field linking it to the last authority.</p></div></section><section id="generateSection" class="step-section hidden"><button id="generateButton" class="btn btn-success">ğŸ“„ 3. Generate TOA at Cursor</button><p class="help-text">Runs Document Hygiene (hides field codes, repaginates), then inserts native <code>{ TOA }</code> fields with passim support.</p></section><details class="settings"><summary>âš™ï¸ Settings</summary><div class="settings-content"><label class="checkbox-label"><input type="checkbox" id="includeFootnotes" checked="checked"/> Include citations from footnotes</label> <label class="setting-label">Passim threshold (pages): <input type="number" id="passimThreshold" value="6" min="3" max="20"/></label> <label class="checkbox-label"><input type="checkbox" id="autoHygiene" checked="checked"/> Auto-run Document Hygiene before TOA generation</label></div></details></main><footer class="footer"><p class="footer-text">After generation, <strong>right-click the TOA â†’ Update Field</strong> to render live page numbers.</p></footer></div><script src="taskpane.js"></script></body></html>
(()=>{"use strict";var t,n={942(t,n,e){e.d(n,{A:()=>i});var s=e(601),o=e.n(s),r=e(314),a=e.n(r)()(o());a.push([t.id,"/* General Styles */\n* {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    font-size: 14px;\n    line-height: 1.6;\n    color: #323130;\n    background-color: #faf9f8;\n}\n\n.container {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    padding: 0;\n}\n\n/* Header */\n.header {\n    background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);\n    color: white;\n    padding: 20px;\n    text-align: center;\n}\n\n.title {\n    font-size: 20px;\n    font-weight: 600;\n    margin-bottom: 5px;\n}\n\n.subtitle {\n    font-size: 12px;\n    opacity: 0.9;\n}\n\n/* Content */\n.content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n}\n\n/* Actions */\n.actions {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin-bottom: 20px;\n}\n\n.button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    padding: 12px 20px;\n    font-size: 14px;\n    font-weight: 600;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n\n.button:hover:not(:disabled) {\n    transform: translateY(-1px);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n}\n\n.button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.button-primary {\n    background-color: #0078d4;\n    color: white;\n}\n\n.button-primary:hover:not(:disabled) {\n    background-color: #106ebe;\n}\n\n.button-success {\n    background-color: #107c10;\n    color: white;\n}\n\n.button-success:hover:not(:disabled) {\n    background-color: #0e6b0e;\n}\n\n.button-icon {\n    font-size: 18px;\n}\n\n/* Status */\n.status {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    padding: 12px;\n    margin-bottom: 15px;\n    border-radius: 4px;\n    background-color: #e1f5fe;\n    border-left: 4px solid #0078d4;\n}\n\n.status.error {\n    background-color: #fde7e9;\n    border-left-color: #d13438;\n}\n\n.status.success {\n    background-color: #dff6dd;\n    border-left-color: #107c10;\n}\n\n.status-icon {\n    font-size: 20px;\n}\n\n.status-message {\n    flex: 1;\n    font-size: 13px;\n}\n\n/* Progress Bar */\n.progress-container {\n    margin-bottom: 20px;\n}\n\n.progress-bar {\n    width: 100%;\n    height: 8px;\n    background-color: #edebe9;\n    border-radius: 4px;\n    overflow: hidden;\n    margin-bottom: 8px;\n}\n\n.progress-fill {\n    height: 100%;\n    background: linear-gradient(90deg, #0078d4 0%, #106ebe 100%);\n    transition: width 0.3s ease;\n    width: 0%;\n}\n\n.progress-text {\n    font-size: 12px;\n    color: #605e5c;\n    text-align: center;\n}\n\n/* Statistics */\n.stats {\n    background-color: white;\n    border-radius: 8px;\n    padding: 15px;\n    margin-bottom: 20px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.stats h3 {\n    font-size: 16px;\n    margin-bottom: 12px;\n    color: #323130;\n}\n\n.stats-content {\n    display: grid;\n    gap: 8px;\n}\n\n.stat-item {\n    display: flex;\n    justify-content: space-between;\n    padding: 8px;\n    background-color: #f3f2f1;\n    border-radius: 4px;\n}\n\n.stat-label {\n    font-weight: 500;\n    color: #605e5c;\n}\n\n.stat-value {\n    font-weight: 600;\n    color: #0078d4;\n}\n\n/* Citations List */\n.citations-list {\n    background-color: white;\n    border-radius: 8px;\n    padding: 15px;\n    margin-bottom: 20px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.citations-list h3 {\n    font-size: 16px;\n    margin-bottom: 8px;\n}\n\n.help-text {\n    font-size: 12px;\n    color: #605e5c;\n    margin-bottom: 12px;\n}\n\n.citations-content {\n    max-height: 400px;\n    overflow-y: auto;\n}\n\n.category-section {\n    margin-bottom: 20px;\n}\n\n.category-header {\n    font-size: 14px;\n    font-weight: 600;\n    color: #0078d4;\n    margin-bottom: 8px;\n    padding: 8px;\n    background-color: #f3f2f1;\n    border-radius: 4px;\n}\n\n.citation-item {\n    display: flex;\n    align-items: flex-start;\n    gap: 10px;\n    padding: 10px;\n    border-bottom: 1px solid #edebe9;\n}\n\n.citation-item:last-child {\n    border-bottom: none;\n}\n\n.citation-checkbox {\n    margin-top: 3px;\n    cursor: pointer;\n}\n\n.citation-text {\n    flex: 1;\n    font-size: 13px;\n    line-height: 1.5;\n}\n\n.citation-pages {\n    font-size: 11px;\n    color: #605e5c;\n    margin-top: 4px;\n}\n\n/* Settings */\n.settings {\n    background-color: white;\n    border-radius: 8px;\n    padding: 15px;\n    margin-bottom: 20px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.settings summary {\n    font-weight: 600;\n    cursor: pointer;\n    user-select: none;\n    list-style: none;\n}\n\n.settings summary::-webkit-details-marker {\n    display: none;\n}\n\n.settings-content {\n    margin-top: 15px;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n}\n\n.checkbox-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n    font-size: 13px;\n}\n\n.setting-label {\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n    font-size: 13px;\n}\n\n.setting-label input[type=\"number\"] {\n    padding: 6px 10px;\n    border: 1px solid #d2d0ce;\n    border-radius: 4px;\n    font-size: 13px;\n}\n\n/* Footer */\n.footer {\n    padding: 15px 20px;\n    background-color: #f3f2f1;\n    border-top: 1px solid #edebe9;\n    text-align: center;\n}\n\n.footer-text {\n    font-size: 12px;\n    color: #605e5c;\n}\n\n.footer-text a {\n    color: #0078d4;\n    text-decoration: none;\n}\n\n.footer-text a:hover {\n    text-decoration: underline;\n}\n\n/* Utility Classes */\n.hidden {\n    display: none !important;\n}\n\n/* Scrollbar Styling */\n::-webkit-scrollbar {\n    width: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: #f3f2f1;\n}\n\n::-webkit-scrollbar-thumb {\n    background: #c8c6c4;\n    border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: #a19f9d;\n}\n",""]);const i=a},314(t){t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var e="",s=void 0!==n[5];return n[4]&&(e+="@supports (".concat(n[4],") {")),n[2]&&(e+="@media ".concat(n[2]," {")),s&&(e+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),e+=t(n),s&&(e+="}"),n[2]&&(e+="}"),n[4]&&(e+="}"),e}).join("")},n.i=function(t,e,s,o,r){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(s)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var d=0;d<t.length;d++){var l=[].concat(t[d]);s&&a[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),e&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=e):l[2]=e),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),n.push(l))}},n}},601(t){t.exports=function(t){return t[1]}},72(t){var n=[];function e(t){for(var e=-1,s=0;s<n.length;s++)if(n[s].identifier===t){e=s;break}return e}function s(t,s){for(var r={},a=[],i=0;i<t.length;i++){var c=t[i],d=s.base?c[0]+s.base:c[0],l=r[d]||0,p="".concat(d," ").concat(l);r[d]=l+1;var u=e(p),g={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)n[u].references++,n[u].updater(g);else{var f=o(g,s);s.byIndex=i,n.splice(i,0,{identifier:p,updater:f,references:1})}a.push(p)}return a}function o(t,n){var e=n.domAPI(n);return e.update(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap&&n.supports===t.supports&&n.layer===t.layer)return;e.update(t=n)}else e.remove()}}t.exports=function(t,o){var r=s(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<r.length;a++){var i=e(r[a]);n[i].references--}for(var c=s(t,o),d=0;d<r.length;d++){var l=e(r[d]);0===n[l].references&&(n[l].updater(),n.splice(l,1))}r=c}}},659(t){var n={};t.exports=function(t,e){var s=function(t){if(void 0===n[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}n[t]=e}return n[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}},540(t){t.exports=function(t){var n=document.createElement("style");return t.setAttributes(n,t.attributes),t.insert(n,t.options),n}},56(t,n,e){t.exports=function(t){var n=e.nc;n&&t.setAttribute("nonce",n)}},825(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=t.insertStyleElement(t);return{update:function(e){!function(t,n,e){var s="";e.supports&&(s+="@supports (".concat(e.supports,") {")),e.media&&(s+="@media ".concat(e.media," {"));var o=void 0!==e.layer;o&&(s+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),s+=e.css,o&&(s+="}"),e.media&&(s+="}"),e.supports&&(s+="}");var r=e.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),n.styleTagTransform(s,t,n.options)}(n,t,e)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)}}}},113(t){t.exports=function(t,n){if(n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}}},e={};function s(t){var o=e[t];if(void 0!==o)return o.exports;var r=e[t]={id:t,exports:{}};return n[t](r,r.exports,s),r.exports}s.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return s.d(n,{a:n}),n},s.d=(t,n)=>{for(var e in n)s.o(n,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},s.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),s.nc=void 0,function(t){t.Cases="Cases",t.Statutes="Statutes",t.Constitutional="Constitutional Provisions",t.Rules="Rules",t.Regulations="Regulations",t.Treatises="Treatises",t.Other="Other Authorities"}(t||(t={}));const o=[{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+([A-Z][A-Za-z0-9.]+)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"Standard case citation"},{pattern:/\b(?:In re|Ex parte)\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+([A-Z][A-Za-z0-9.\s]+)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Z][A-Za-z.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"In re / Ex parte case citation"},{pattern:/\b([A-Z][A-Za-z]+),\s+(\d+)\s+([A-Z][A-Za-z0-9.]+)\s+at\s+(\d+)/gi,category:t.Cases,description:"Short form case citation",isShortForm:!0},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+S\.\s*Ct\.\s+(\d+)(?:,\s+(\d+))?\s+\((\d{4})\)/gi,category:t.Cases,description:"Case with S. Ct. reporter"},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+(F\.\s*Supp\.(?:\s*\d+d)?)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"Case with F. Supp. reporter"},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+Fed\.\s*App['']?x\.?\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"Case with Fed. Appx reporter"},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(?:No\.\s*[\w-]+,\s*)?(\d{4})\s+WL\s+(\d+)\s*\(([A-Za-z0-9.\s]+\d{4})\)/gi,category:t.Cases,description:"Westlaw citation"},{pattern:/\bNo\.\s*([\w:-]+),\s*(\d{4})\s+(?:WL|U\.S\.\s*(?:Dist\.\s*)?LEXIS)\s+(\d+)/gi,category:t.Cases,description:"Case number with WL/LEXIS"},{pattern:/\bId\.\s*(?:at\s+(\d+))?/gi,category:t.Cases,description:"Id. citation",isShortForm:!0},{pattern:/\b(\d+)\s+U\.?S\.?C\.?\s+§+\s*([\d\w\-]+(?:\([a-z0-9]+\))?(?:\s*-\s*[\d\w]+)?)/gi,category:t.Statutes,description:"Federal statute (U.S.C.)"},{pattern:/\bCal\.\s+([A-Z][A-Za-z.]+)\s+Code\s+§\s*([\d\w\-]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"California statute"},{pattern:/\bN\.Y\.\s+([A-Z][A-Za-z.\s]+)\s+(?:Law\s+)?§\s*([\d\w\-]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"New York statute"},{pattern:/\bTex\.\s+([A-Z][A-Za-z.]+)\s+Code\s+Ann\.\s+§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Texas statute"},{pattern:/\bFla\.\s+Stat\.\s+§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Florida statute"},{pattern:/\b(\d+)\s+ILCS\s+([\d\w\/\-]+)/gi,category:t.Statutes,description:"Illinois statute"},{pattern:/\b([A-Z][A-Za-z.]+)\s+([A-Z][A-Za-z.\s]+)\s+(?:Code\s+)?§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Generic state statute"},{pattern:/\bU\.?S\.?\s+Const\.\s+art\.\s+([IVXLCDM]+)(?:,\s+§\s*(\d+))?/gi,category:t.Constitutional,description:"U.S. Constitution article"},{pattern:/\bU\.?S\.?\s+Const\.\s+amend\.\s+([IVXLCDM]+)(?:,\s+§\s*(\d+))?/gi,category:t.Constitutional,description:"U.S. Constitution amendment"},{pattern:/\b([A-Z][A-Za-z.]+)\s+Const\.\s+art\.\s+([IVXLCDM]+)(?:,\s+§\s*(\d+))?/gi,category:t.Constitutional,description:"State constitution"},{pattern:/\bFed\.\s+R\.\s+Civ\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\))*)/gi,category:t.Rules,description:"Federal Rules of Civil Procedure"},{pattern:/\bFed\.\s+R\.\s+Evid\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Evidence"},{pattern:/\bFed\.\s+R\.\s+App\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Appellate Procedure"},{pattern:/\bFed\.\s+R\.\s+Crim\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Criminal Procedure"},{pattern:/\bCal\.\s+Rules?\s+of\s+Court,?\s+rule\s+([\d\.]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"California Rules of Court"},{pattern:/\b([A-Z][A-Za-z.]+)\s+R\.\s+([A-Za-z.]+)\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"State rules"},{pattern:/\b(\d+)\s+C\.F\.R\.\s+§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Regulations,description:"Code of Federal Regulations"},{pattern:/\b(\d+)\s+Fed\.\s+Reg\.\s+(\d+)\s+\(([A-Za-z.]+\s+\d+,\s+\d{4})\)/gi,category:t.Regulations,description:"Federal Register"},{pattern:/\b(\d+)\s+([A-Z][A-Za-z &]+?),\s+([A-Za-z &]+)\s+§\s*([\d.]+)\s+\((\d+[a-z]*\s+ed\.\s+\d{4})\)/gi,category:t.Treatises,description:"Treatise with edition"},{pattern:/\b([A-Z][A-Za-z\s.]+),\s+([A-Za-z\s:]+),\s+(\d+)\s+([A-Z][A-Za-z.\s]+)\s+L\.\s+Rev\.\s+(\d+)\s+\((\d{4})\)/gi,category:t.Treatises,description:"Law review article"},{pattern:/\bRestatement\s+\(([A-Za-z]+)\)\s+of\s+([A-Za-z\s]+)\s+§\s*([\d\w]+)/gi,category:t.Treatises,description:"Restatement"},{pattern:/\b(\d+)\s+Witkin,\s+([A-Za-z\s.]+)\s+§\s*([\d]+)\s+\((\d+(?:st|nd|rd|th)\s+ed\.\s+\d{4})\)/gi,category:t.Treatises,description:"Witkin treatise"},{pattern:/\b([A-Z][A-Za-z]+),\s+supra(?:,\s+(?:note\s+\d+,\s+)?at\s+(\d+))?/gi,category:t.Cases,description:"Supra citation",isShortForm:!0}];function r(t){let n=t.trim();return n=n.replace(/\s+/g," "),n=n.replace(/§§/g,"§").replace(/sect\./gi,"§"),n=n.replace(/\bU\.?S\.?C\.?\b/gi,"U.S.C."),n=n.replace(/\bUSC\b/gi,"U.S.C."),n=n.replace(/\bC\.?F\.?R\.?\b/gi,"C.F.R."),n=n.replace(/\bCFR\b/gi,"C.F.R."),n=n.replace(/\s+(?:vs\.|versus)\s+/gi," v. "),n=n.replace(/[,;]\s*$/,""),n=n.replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"').replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g,"'"),n}function a(t){const n=t.match(/^([A-Z][A-Za-z\s&.'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.'-]+?)(?:,\s*\d|\s+\d)/i);if(n)return`${n[1].trim()} v. ${n[2].trim()}`;const e=t.match(/^(?:In re|Ex parte)\s+([A-Z][A-Za-z\s&.,'-]+)/i);return e?e[0].trim():null}function i(n,e){switch(e){case t.Cases:{const t=n.match(/(\d+)\s+([A-Za-z.0-9]+)\s+(\d+)/);if(t)return`${t[1]} ${t[2]} ${t[3]}`.toUpperCase();break}case t.Statutes:{const t=n.match(/(\d+)\s+U\.?S\.?C\.?\s+§\s*([\d\w\-]+)/i);if(t)return`${t[1]} U.S.C. ${t[2]}`.toUpperCase();const e=n.match(/([A-Za-z.]+)\s+[A-Za-z.\s]*\s+§\s*([\d\w\-\.]+)/i);if(e)return`${e[1]} ${e[2]}`.toUpperCase();break}case t.Constitutional:{const t=n.match(/(U\.S\.|[A-Z][A-Za-z.]+)\s+Const\.\s+(art\.|amend\.)\s+([IVXLCDM\d]+)/i);if(t)return`${t[1]} Const. ${t[2]} ${t[3]}`.toUpperCase();break}case t.Rules:{const t=n.match(/(Fed\.|[A-Z][A-Za-z.]+)\s+R\.\s+([A-Za-z.]+)\s+P\.\s+([\d]+)/i);if(t)return`${t[1]} R. ${t[2]} P. ${t[3]}`.toUpperCase();break}case t.Regulations:{const t=n.match(/(\d+)\s+C\.F\.R\.\s+§\s*([\d\w\-\.]+)/i);if(t)return`${t[1]} C.F.R. ${t[2]}`.toUpperCase();break}}return r(n).toUpperCase()}function c(n,e){if(/^Id\./i.test(n))return null;const s=n.match(/^([A-Z][A-Za-z]+),\s+supra/i);if(s){const n=s[1].toLowerCase();for(const s of e)if(s.category===t.Cases&&!s.isShortForm){const t=a(s.text);if(t&&t.toLowerCase().includes(n))return s.id}}const o=n.match(/^([A-Z][A-Za-z]+),\s+(\d+)\s+([A-Za-z.0-9]+)\s+at/i);if(o){const n=o[1].toLowerCase(),s=o[2],r=o[3];for(const o of e)if(o.category===t.Cases&&!o.isShortForm){const t=a(o.text),e=o.text.match(/(\d+)\s+([A-Za-z.0-9]+)\s+(\d+)/);if(t&&t.toLowerCase().includes(n)&&e&&e[1]===s&&e[2].toLowerCase()===r.toLowerCase())return o.id}}return null}function d(n){return[...n].sort((n,e)=>{if(n.category===t.Cases&&e.category===t.Cases){const t=a(n.text)||n.text,s=a(e.text)||e.text;return t.localeCompare(s,"en",{sensitivity:"base"})}return n.normalizedText.localeCompare(e.normalizedText,"en",{sensitivity:"base"})})}function l(t){const n=new Map;for(const e of t)n.has(e.category)||n.set(e.category,[]),n.get(e.category).push(e);for(const[t,e]of n.entries())n.set(t,d(e));return n}const p=[t.Cases,t.Statutes,t.Constitutional,t.Rules,t.Regulations,t.Treatises,t.Other],u={[t.Cases]:"CASES",[t.Statutes]:"STATUTES",[t.Constitutional]:"CONSTITUTIONAL PROVISIONS",[t.Rules]:"RULES",[t.Regulations]:"REGULATIONS",[t.Treatises]:"TREATISES",[t.Other]:"OTHER AUTHORITIES"};function g(t){return t.replace(/([^.!?\n])\n([a-z])/g,"$1 $2").replace(/\n(at\s+\d)/g," $1").replace(/\n(v\.\s)/g," $1").replace(/\n(\d+\s+(?:U\.S\.|S\.Ct\.|F\.\d|L\.Ed))/g," $1").replace(/[ \t]+/g," ")}const f={passimThreshold:6,maxLineLength:80,includePageCounts:!1,useDotLeaders:!0,wrapIndent:"  "};function m(t,n){const e=function(t,n){const e=[...new Set(t)].sort((t,n)=>t-n);return e.length>=n.passimThreshold?`${e.slice(0,n.passimThreshold).join(", ")}, passim`:e.join(", ")}(t.pages,n);if(n.useDotLeaders){const s=function(t,n,e){const s=t.length+n.length;if(s>=e-3)return` ............. ${n}`;const o=e-s-2;return` ${".".repeat(Math.max(1,o))} ${n}`}(t.text,e,n.maxLineLength);return`${t.text}${s}`}return`${t.text} ${e}`}function x(t){let n=t.match(/^([A-Z][A-Za-z\s&.'-]+\s+v\.\s+[A-Z][A-Za-z\s&.'-]+?)(?=,\s*\d|\s+\d)/);if(n||(n=t.match(/^((?:In re|Ex parte)\s+[A-Z][A-Za-z\s&.'-]+?)(?=,\s*\d|\s+\d)/)),n){const e=n[1];return t.replace(e,`_${e}_`)}return t}function h(n,e,s){const o=[];if(o.push(""),o.push(function(t){return u[t]}(n)),o.push(""),e.length>0){const t=s.includePageCounts?"Page(s)":"";t&&(o.push(`${" ".repeat(60)}${t}`),o.push(""))}for(const r of e){let e=r.text;n===t.Cases&&(e=x(e));const a=m({...r,text:e},s);o.push(a)}return o.join("\n")}function b(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var y=s(72),A=s.n(y),w=s(825),C=s.n(w),v=s(659),z=s.n(v),Z=s(56),S=s.n(Z),I=s(540),T=s.n(I),E=s(113),R=s.n(E),F=s(942),$={};$.styleTagTransform=R(),$.setAttributes=S(),$.insert=z().bind(null,"head"),$.domAPI=C(),$.insertStyleElement=T(),A()(F.A,$),F.A&&F.A.locals&&F.A.locals;let L=[];function k(t,n){const e=document.getElementById("status"),s=document.getElementById("statusMessage");e&&s&&(e.className=`status ${n}`,s.textContent=t,e.classList.remove("hidden"))}function U(){document.getElementById("status")?.classList.add("hidden")}function B(t,n){const e=document.getElementById("progressContainer"),s=document.getElementById("progressBar"),o=document.getElementById("progressText");e&&s&&o&&(e.classList.remove("hidden"),s.style.width=`${t}%`,o.textContent=n)}function P(){document.getElementById("progressContainer")?.classList.add("hidden")}async function O(){try{U(),B(0,"Reading document...");const t=document.getElementById("scanButton");t&&(t.disabled=!0),await Word.run(async t=>{B(20,"Extracting text...");const n=t.document.body.paragraphs;n.load("text"),await t.sync(),B(40,"Analyzing citations...");const e=new Map;let s=1,a="";for(let t=0;t<n.items.length;t++)a+=n.items[t].text+"\n",a.length>3e3&&(e.set(s,a),s++,a="");a&&e.set(s,a),B(60,"Detecting citation patterns...");const d=document.getElementById("includeFootnotes")?.checked??!0,p=function(t,n,e={}){const s={includeFootnotes:!0,minConfidence:.7,customPatterns:[],...e},a=[...o,...s.customPatterns||[]],d=[];for(const[t,e]of n.entries()){const n=g(e);for(const e of a){const s=new RegExp(e.pattern.source,e.pattern.flags);let o;for(;null!==(o=s.exec(n));)d.push({text:o[0],category:e.category,startIndex:o.index,endIndex:o.index+o[0].length,pageNumber:t,isShortForm:e.isShortForm||!1})}}const l=function(t){const n=[],e=new Map;for(const s of t){const t=i(s.text,s.category);if(e.has(t)){const o=n[e.get(t)],r=s.pages.filter(t=>!o.pages.includes(t));o.pages.push(...r),o.pages.sort((t,n)=>t-n),s.text.length>o.text.length&&(o.text=s.text,o.normalizedText=s.normalizedText)}else e.set(t,n.length),n.push({...s})}return n}(d.map(t=>({id:`cit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:t.text,originalText:t.text,normalizedText:r(t.text),category:t.category,pages:[t.pageNumber],isShortForm:t.isShortForm,isIncluded:!0})));for(const t of l)if(t.isShortForm){const n=c(t.text,l);n&&(t.parentCitationId=n)}return{citations:l,totalPages:n.size,fullText:t}}(Array.from(e.values()).join("\n"),e,{includeFootnotes:d});B(80,"Organizing citations..."),L=p.citations,B(100,"Done!"),function(t){const n=document.getElementById("stats"),e=document.getElementById("statsContent");if(!n||!e)return;const s=new Map;for(const n of t)if(!n.isShortForm){const t=n.category;s.set(t,(s.get(t)||0)+1)}let o="";for(const[t,n]of s.entries())o+=`\n      <div class="stat-item">\n        <span class="stat-label">${t}</span>\n        <span class="stat-value">${n}</span>\n      </div>\n    `;o+=`\n    <div class="stat-item">\n      <span class="stat-label"><strong>Total Citations</strong></span>\n      <span class="stat-value"><strong>${t.filter(t=>!t.isShortForm).length}</strong></span>\n    </div>\n  `,e.innerHTML=o,n.classList.remove("hidden")}(L),function(t){const n=document.getElementById("citationsList"),e=document.getElementById("citationsContent");if(!n||!e)return;const s=function(t){return l(t)}(t);let o="";for(const[t,n]of s.entries()){const e=n.filter(t=>!t.isShortForm);if(0!==e.length){o+='<div class="category-section">',o+=`<div class="category-header">${t} (${e.length})</div>`;for(const t of e){const n=t.pages.join(", ");o+=`\n        <div class="citation-item">\n          <input \n            type="checkbox" \n            class="citation-checkbox" \n            data-citation-id="${t.id}"\n            ${t.isIncluded?"checked":""}\n          />\n          <div class="citation-text">\n            ${N(t.text)}\n            <div class="citation-pages">Pages: ${n}</div>\n          </div>\n        </div>\n      `}o+="</div>"}}e.innerHTML=o,e.querySelectorAll(".citation-checkbox").forEach(t=>{t.addEventListener("change",t=>{const n=t.target,e=n.dataset.citationId,s=L.find(t=>t.id===e);s&&(s.isIncluded=n.checked)})}),n.classList.remove("hidden")}(L);const u=document.getElementById("generateButton");u&&(u.disabled=!1),P(),k(`Found ${L.length} citations`,"success")})}catch(t){console.error("Error scanning document:",t),P(),k(`Error: ${t.message||"Failed to scan document"}`,"error")}finally{const t=document.getElementById("scanButton");t&&(t.disabled=!1)}}async function M(){try{U(),B(0,"Preparing Table of Authorities...");const t=document.getElementById("generateButton");t&&(t.disabled=!0);const n=parseInt(document.getElementById("passimThreshold")?.value||"6"),e=document.getElementById("useDotLeaders")?.checked??!0;B(30,"Formatting citations...");const s=function(t,n={}){const e=function(t,n={}){const e={...f,...n},s=[];s.push("TABLE OF AUTHORITIES"),s.push("");for(const n of p){const o=t.get(n);o&&o.length>0&&s.push(h(n,o,e))}return s.join("\n")}(l(n.onlyIncluded?t.filter(t=>t.isIncluded&&!t.isShortForm):t.filter(t=>!t.isShortForm)),n.format);return n.asOOXML?function(t){const n=t.split("\n");let e='<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">';e+="<w:body>";for(const t of n){if(e+="<w:p>","TABLE OF AUTHORITIES"===t.trim())e+='<w:pPr><w:jc w:val="center"/></w:pPr>',e+='<w:r><w:rPr><w:b/><w:sz w:val="28"/></w:rPr>',e+=`<w:t>${t}</w:t></w:r>`;else if(t.trim()&&t.trim()===t.trim().toUpperCase()&&t.trim().length>3)e+="<w:r><w:rPr><w:b/></w:rPr>",e+=`<w:t>${t}</w:t></w:r>`;else if(t.includes("_")){const n=t.split("_");for(let t=0;t<n.length;t++)t%2==0?e+=`<w:r><w:t xml:space="preserve">${b(n[t])}</w:t></w:r>`:(e+="<w:r><w:rPr><w:i/></w:rPr>",e+=`<w:t xml:space="preserve">${b(n[t])}</w:t></w:r>`)}else e+=`<w:r><w:t xml:space="preserve">${b(t)}</w:t></w:r>`;e+="</w:p>"}return e+="</w:body>",e+="</w:document>",e}(e):e}(L,{onlyIncluded:!0,asOOXML:!1,format:{passimThreshold:n,useDotLeaders:e}});B(60,"Inserting into document..."),await Word.run(async t=>{const n=t.document.getSelection().insertParagraph(s,Word.InsertLocation.before);n.font.size=12,n.font.name="Times New Roman",await t.sync(),B(100,"Complete!")}),P(),k(`Table of Authorities generated with ${L.filter(t=>t.isIncluded&&!t.isShortForm).length} citations`,"success")}catch(t){console.error("Error generating TOA:",t),P(),k(`Error: ${t.message||"Failed to generate TOA"}`,"error")}finally{const t=document.getElementById("generateButton");t&&(t.disabled=!1)}}function N(t){const n=document.createElement("div");return n.textContent=t,n.innerHTML}Office.onReady(t=>{t.host===Office.HostType.Word&&(document.getElementById("scanButton")?.addEventListener("click",O),document.getElementById("generateButton")?.addEventListener("click",M),k("Ready to scan document","info"))})})();
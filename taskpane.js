(()=>{"use strict";var t,e={942(t,e,n){n.d(e,{A:()=>i});var s=n(601),o=n.n(s),r=n(314),a=n.n(r)()(o());a.push([t.id,"/* â”€â”€â”€ AutoTOA Task Pane Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\nbody {\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n  padding: 0;\n  margin: 0;\n  background: #f3f2f1;\n  color: #323130;\n  font-size: 13px;\n}\n\n.container {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  padding: 16px;\n}\n\n/* â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.header {\n  margin-bottom: 16px;\n}\n\n.header h2 {\n  margin: 0 0 4px;\n  font-size: 18px;\n  color: #0078d4;\n}\n\n.desc {\n  color: #605e5c;\n  margin: 0;\n  font-size: 12px;\n}\n\n/* â”€â”€â”€ Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.btn {\n  width: 100%;\n  padding: 10px 14px;\n  font-size: 13px;\n  font-weight: 600;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: background 0.15s;\n  margin-bottom: 8px;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-primary {\n  background: #0078d4;\n  color: #fff;\n}\n.btn-primary:hover:not(:disabled) {\n  background: #106ebe;\n}\n\n.btn-mark {\n  background: #8764b8;\n  color: #fff;\n}\n.btn-mark:hover:not(:disabled) {\n  background: #6b4f9e;\n}\n\n.btn-id {\n  background: #ca5010;\n  color: #fff;\n}\n.btn-id:hover:not(:disabled) {\n  background: #a33d0b;\n}\n\n.btn-success {\n  background: #107c41;\n  color: #fff;\n}\n.btn-success:hover:not(:disabled) {\n  background: #0b5a2f;\n}\n\n/* â”€â”€â”€ Steps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.step-section {\n  margin-bottom: 4px;\n}\n\n.hidden {\n  display: none !important;\n}\n\n/* â”€â”€â”€ Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.status {\n  padding: 8px 10px;\n  border-radius: 4px;\n  margin-bottom: 10px;\n  font-size: 12px;\n  line-height: 1.4;\n}\n\n.status.info {\n  background: #deecf9;\n  color: #004578;\n}\n\n.status.success {\n  background: #dff6dd;\n  color: #0b6a0b;\n}\n\n.status.error {\n  background: #fde7e9;\n  color: #a4262c;\n}\n\n/* â”€â”€â”€ Progress â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.progress-container {\n  margin-bottom: 10px;\n}\n\n.progress-bar {\n  height: 4px;\n  background: #edebe9;\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.progress-fill {\n  height: 100%;\n  background: #0078d4;\n  transition: width 0.3s;\n  width: 0;\n}\n\n.progress-text {\n  font-size: 11px;\n  color: #605e5c;\n  margin-top: 3px;\n}\n\n/* â”€â”€â”€ Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.stats {\n  margin-bottom: 12px;\n}\n\n.stats h3 {\n  font-size: 13px;\n  margin: 0 0 6px;\n  border-bottom: 1px solid #c8c6c4;\n  padding-bottom: 4px;\n}\n\n.stat-row {\n  display: flex;\n  justify-content: space-between;\n  padding: 3px 0;\n  font-size: 12px;\n}\n\n.stat-row.total {\n  border-top: 1px solid #c8c6c4;\n  margin-top: 4px;\n  padding-top: 4px;\n}\n\n/* â”€â”€â”€ Citation List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.citations-list {\n  margin-bottom: 12px;\n}\n\n.citations-list h3 {\n  font-size: 13px;\n  margin: 0 0 4px;\n}\n\n.help-text {\n  font-size: 11px;\n  color: #605e5c;\n  margin: 0 0 8px;\n  line-height: 1.4;\n}\n\n.help-text code {\n  background: #edebe9;\n  padding: 1px 4px;\n  border-radius: 2px;\n  font-size: 11px;\n}\n\n.cat-group {\n  margin-bottom: 10px;\n}\n\n.cat-title {\n  font-weight: 600;\n  font-size: 12px;\n  color: #0078d4;\n  margin-bottom: 4px;\n}\n\n.cite-row {\n  display: flex;\n  align-items: flex-start;\n  background: #fff;\n  padding: 6px 8px;\n  margin-bottom: 4px;\n  border-radius: 4px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.cite-row input[type='checkbox'] {\n  margin: 2px 8px 0 0;\n  flex-shrink: 0;\n}\n\n.cite-body {\n  flex: 1;\n  min-width: 0;\n}\n\n.cite-long {\n  word-break: break-word;\n  line-height: 1.35;\n}\n\n.cite-short {\n  color: #8764b8;\n  font-size: 11px;\n  margin-top: 2px;\n}\n\n.cite-pages {\n  color: #605e5c;\n  font-size: 11px;\n  margin-top: 1px;\n}\n\n/* â”€â”€â”€ Id. Resolver â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.id-resolver {\n  background: #fff4ce;\n  padding: 10px;\n  border-radius: 4px;\n  margin-bottom: 8px;\n}\n\n.id-status {\n  font-size: 12px;\n  margin-bottom: 8px;\n}\n\n.last-marked {\n  color: #ca5010;\n  font-weight: 600;\n}\n\n/* â”€â”€â”€ Settings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.settings {\n  margin-top: 8px;\n  font-size: 12px;\n}\n\n.settings summary {\n  cursor: pointer;\n  font-weight: 600;\n  padding: 6px 0;\n}\n\n.settings-content {\n  padding: 8px 0;\n}\n\n.checkbox-label,\n.setting-label {\n  display: block;\n  margin-bottom: 8px;\n  font-size: 12px;\n}\n\n.setting-label input[type='number'] {\n  width: 50px;\n  margin-left: 6px;\n  padding: 3px;\n  border: 1px solid #c8c6c4;\n  border-radius: 3px;\n}\n\n/* â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n.footer {\n  margin-top: auto;\n  padding-top: 12px;\n  border-top: 1px solid #edebe9;\n  text-align: center;\n}\n\n.footer-text {\n  font-size: 11px;\n  color: #605e5c;\n  margin: 0;\n}\n",""]);const i=a},314(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",s=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),s&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),s&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,s,o,r){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(s)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(a[c]=!0)}for(var d=0;d<t.length;d++){var l=[].concat(t[d]);s&&a[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},601(t){t.exports=function(t){return t[1]}},72(t){var e=[];function n(t){for(var n=-1,s=0;s<e.length;s++)if(e[s].identifier===t){n=s;break}return n}function s(t,s){for(var r={},a=[],i=0;i<t.length;i++){var c=t[i],d=s.base?c[0]+s.base:c[0],l=r[d]||0,u="".concat(d," ").concat(l);r[d]=l+1;var p=n(u),g={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)e[p].references++,e[p].updater(g);else{var f=o(g,s);s.byIndex=i,e.splice(i,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var r=s(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<r.length;a++){var i=n(r[a]);e[i].references--}for(var c=s(t,o),d=0;d<r.length;d++){var l=n(r[d]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}r=c}}},659(t){var e={};t.exports=function(t,n){var s=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},540(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56(t,e,n){t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,o&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},n={};function s(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={id:t,exports:{}};return e[t](r,r.exports,s),r.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.nc=void 0,function(t){t.Cases="Cases",t.Statutes="Statutes",t.Constitutional="Constitutional Provisions",t.Rules="Rules",t.Regulations="Regulations",t.Treatises="Treatises",t.Other="Other Authorities"}(t||(t={}));const o=[{pattern:/(?:^|(?<=[ \t,;(\n]))((?:[A-Z][\w.'&,-]{0,30})(?:[ \t]+(?:of|the|for|and|&|on|to|d|l|[A-Z][\w.'&,-]{0,30}|\d+)){0,6})[ \t]+v\.[ \t]+((?:[A-Z][\w.'&,-]{0,30})(?:[ \t]+(?:of|the|for|and|&|on|to|d|l|[A-Z][\w.'&,-]{0,30}|\d+)){0,6}),\s+(\d+)\s+([A-Z][A-Za-z0-9.]+)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9. ]{0,30})[ \t]+)?(\d{4})\)/gim,category:t.Cases,description:"Standard case citation"},{pattern:/\b(?:In re|Ex parte)\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+([A-Z][A-Za-z0-9.\s]+)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Z][A-Za-z.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"In re / Ex parte case citation"},{pattern:/\b([A-Z][A-Za-z]+),\s+(\d+)\s+([A-Z][A-Za-z0-9.]+)\s+at\s+(\d+)/gi,category:t.Cases,description:"Short form case citation",isShortForm:!0},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+S\.\s*Ct\.\s+(\d+)(?:,\s+(\d+))?\s+\((\d{4})\)/gi,category:t.Cases,description:"Case with S. Ct. reporter"},{pattern:/(?:^|(?<=[ \t,;(\n]))((?:[A-Z][\w.'&,-]{0,30})(?:[ \t]+(?:of|the|for|and|&|on|to|d|l|[A-Z][\w.'&,-]{0,30}|\d+)){0,6})[ \t]+v\.[ \t]+((?:[A-Z][\w.'&,-]{0,30})(?:[ \t]+(?:of|the|for|and|&|on|to|d|l|[A-Z][\w.'&,-]{0,30}|\d+)){0,6}),\s+(\d+)\s+(F\.\s*Supp\.(?:\s*\d+d)?)\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9. ]{0,30})[ \t]+)?(\d{4})\)/gim,category:t.Cases,description:"Case with F. Supp. reporter"},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(\d+)\s+Fed\.\s*App['']?x\.?\s+(\d+)(?:,\s+(\d+))?\s+\((?:([A-Za-z0-9][A-Za-z0-9.\s]+)\s+)?(\d{4})\)/gi,category:t.Cases,description:"Case with Fed. Appx reporter"},{pattern:/\b([A-Z][A-Za-z\s&.,'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.,'-]+),\s+(?:No\.\s*[\w-]+,\s*)?(\d{4})\s+WL\s+(\d+)\s*\(([A-Za-z0-9.\s]+\d{4})\)/gi,category:t.Cases,description:"Westlaw citation"},{pattern:/\bNo\.\s*([\w:-]+),\s*(\d{4})\s+(?:WL|U\.S\.\s*(?:Dist\.\s*)?LEXIS)\s+(\d+)/gi,category:t.Cases,description:"Case number with WL/LEXIS"},{pattern:/\bId\.\s*(?:at\s+(\d+))?/gi,category:t.Cases,description:"Id. citation",isShortForm:!0},{pattern:/\b(\d+)\s+U\.?S\.?C\.?\s+Â§+\s*([\d\w\-]+(?:\([a-z0-9]+\))?(?:\s*-\s*[\d\w]+)?)/gi,category:t.Statutes,description:"Federal statute (U.S.C.)"},{pattern:/\bCal\.\s+([A-Z][A-Za-z.]+)\s+Code\s+Â§\s*([\d\w\-]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"California statute"},{pattern:/\bN\.Y\.\s+([A-Z][A-Za-z.\s]+)\s+(?:Law\s+)?Â§\s*([\d\w\-]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"New York statute"},{pattern:/\bTex\.\s+([A-Z][A-Za-z.]+)\s+Code\s+Ann\.\s+Â§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Texas statute"},{pattern:/\bFla\.\s+Stat\.\s+Â§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Florida statute"},{pattern:/\b(\d+)\s+ILCS\s+([\d\w\/\-]+)/gi,category:t.Statutes,description:"Illinois statute"},{pattern:/\b([A-Z][A-Za-z.]+)\s+([A-Z][A-Za-z.\s]+)\s+(?:Code\s+)?Â§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Statutes,description:"Generic state statute"},{pattern:/\bU\.?S\.?\s+Const\.\s+art\.\s+([IVXLCDM]+)(?:,\s+Â§\s*(\d+))?/gi,category:t.Constitutional,description:"U.S. Constitution article"},{pattern:/\bU\.?S\.?\s+Const\.\s+amend\.\s+([IVXLCDM]+)(?:,\s+Â§\s*(\d+))?/gi,category:t.Constitutional,description:"U.S. Constitution amendment"},{pattern:/\b([A-Z][A-Za-z.]+)\s+Const\.\s+art\.\s+([IVXLCDM]+)(?:,\s+Â§\s*(\d+))?/gi,category:t.Constitutional,description:"State constitution"},{pattern:/\bFed\.\s+R\.\s+Civ\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\))*)/gi,category:t.Rules,description:"Federal Rules of Civil Procedure"},{pattern:/\bFed\.\s+R\.\s+Evid\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Evidence"},{pattern:/\bFed\.\s+R\.\s+App\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Appellate Procedure"},{pattern:/\bFed\.\s+R\.\s+Crim\.\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"Federal Rules of Criminal Procedure"},{pattern:/\bCal\.\s+Rules?\s+of\s+Court,?\s+rule\s+([\d\.]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"California Rules of Court"},{pattern:/\b([A-Z][A-Za-z.]+)\s+R\.\s+([A-Za-z.]+)\s+P\.\s+([\d]+(?:\([a-z0-9]+\)?)*)/gi,category:t.Rules,description:"State rules"},{pattern:/\b(\d+)\s+C\.F\.R\.\s+Â§\s*([\d\w\-\.]+(?:\([a-z0-9]+\)?)?)/gi,category:t.Regulations,description:"Code of Federal Regulations"},{pattern:/\b(\d+)\s+Fed\.\s+Reg\.\s+(\d+)\s+\(([A-Za-z.]+\s+\d+,\s+\d{4})\)/gi,category:t.Regulations,description:"Federal Register"},{pattern:/\b(\d+)\s+([A-Z][A-Za-z &]+?),\s+([A-Za-z &]+)\s+Â§\s*([\d.]+)\s+\((\d+[a-z]*\s+ed\.\s+\d{4})\)/gi,category:t.Treatises,description:"Treatise with edition"},{pattern:/\b([A-Z][A-Za-z .]{1,40}),\s+([A-Za-z :]{1,60}),\s+(\d+)\s+([A-Z][A-Za-z. ]{1,30})\s+L\.\s+Rev\.\s+(\d+)\s+\((\d{4})\)/gi,category:t.Treatises,description:"Law review article"},{pattern:/\bRestatement\s+\(([A-Za-z]+)\)\s+of\s+([A-Za-z ]{1,40})\s+Â§\s*([\d\w]+)/gi,category:t.Treatises,description:"Restatement"},{pattern:/\b(\d+)\s+Witkin,\s+([A-Za-z .]{1,50})\s+Â§\s*([\d]+)\s+\((\d+(?:st|nd|rd|th)\s+ed\.\s+\d{4})\)/gi,category:t.Treatises,description:"Witkin treatise"},{pattern:/\b([A-Z][A-Za-z.'& -]{1,40}),\s+([A-Z][A-Za-z'&.,\- ]{1,60})\s+Â§\s*([\d.-]+)\s+\((?:(?:\d+[a-z]*\s+ed\.\s+)?\d{4})\)/gi,category:t.Treatises,description:"Treatise without volume"},{pattern:/\b([A-Z][A-Za-z]+),\s+supra(?:,\s+(?:note\s+\d+,\s+)?at\s+(\d+))?/gi,category:t.Cases,description:"Supra citation",isShortForm:!0}];function r(t){let e=t.trim();return e=e.replace(/\s+/g," "),e=e.replace(/Â§Â§/g,"Â§").replace(/sect\./gi,"Â§"),e=e.replace(/\bU\.?S\.?C\.?\b/gi,"U.S.C."),e=e.replace(/\bUSC\b/gi,"U.S.C."),e=e.replace(/\bC\.?F\.?R\.?\b/gi,"C.F.R."),e=e.replace(/\bCFR\b/gi,"C.F.R."),e=e.replace(/\s+(?:vs\.|versus)\s+/gi," v. "),e=e.replace(/[,;]\s*$/,""),e=e.replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"').replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g,"'"),e}function a(t){const e=t.match(/^([A-Z][A-Za-z\s&.'-]+)\s+v\.\s+([A-Z][A-Za-z\s&.'-]+?)(?:,\s*\d|\s+\d)/i);if(e)return`${e[1].trim()} v. ${e[2].trim()}`;const n=t.match(/^(?:In re|Ex parte)\s+([A-Z][A-Za-z\s&.,'-]+)/i);return n?n[0].trim():null}function i(e,n){switch(n){case t.Cases:{const t=e.match(/(\d+)\s+([A-Za-z.0-9]+)\s+(\d+)/);if(t)return`${t[1]} ${t[2]} ${t[3]}`.toUpperCase();break}case t.Statutes:{const t=e.match(/(\d+)\s+U\.?S\.?C\.?\s+Â§\s*([\d\w\-]+)/i);if(t)return`${t[1]} U.S.C. ${t[2]}`.toUpperCase();const n=e.match(/([A-Za-z.]+)\s+[A-Za-z.\s]*\s+Â§\s*([\d\w\-\.]+)/i);if(n)return`${n[1]} ${n[2]}`.toUpperCase();break}case t.Constitutional:{const t=e.match(/(U\.S\.|[A-Z][A-Za-z.]+)\s+Const\.\s+(art\.|amend\.)\s+([IVXLCDM\d]+)/i);if(t)return`${t[1]} Const. ${t[2]} ${t[3]}`.toUpperCase();break}case t.Rules:{const t=e.match(/(Fed\.|[A-Z][A-Za-z.]+)\s+R\.\s+([A-Za-z.]+)\s+P\.\s+([\d]+)/i);if(t)return`${t[1]} R. ${t[2]} P. ${t[3]}`.toUpperCase();break}case t.Regulations:{const t=e.match(/(\d+)\s+C\.F\.R\.\s+Â§\s*([\d\w\-\.]+)/i);if(t)return`${t[1]} C.F.R. ${t[2]}`.toUpperCase();break}}return r(e).toUpperCase()}function c(e,n){if(/^Id\./i.test(e))return null;const s=e.match(/^([A-Z][A-Za-z]+),\s+supra/i);if(s){const e=s[1].toLowerCase();for(const s of n)if(s.category===t.Cases&&!s.isShortForm){const t=a(s.text);if(t&&t.toLowerCase().includes(e))return s.id}}const o=e.match(/^([A-Z][A-Za-z]+),\s+(\d+)\s+([A-Za-z.0-9]+)\s+at/i);if(o){const e=o[1].toLowerCase(),s=o[2],r=o[3];for(const o of n)if(o.category===t.Cases&&!o.isShortForm){const t=a(o.text),n=o.text.match(/(\d+)\s+([A-Za-z.0-9]+)\s+(\d+)/);if(t&&t.toLowerCase().includes(e)&&n&&n[1]===s&&n[2].toLowerCase()===r.toLowerCase())return o.id}}return null}function d(e){return[...e].sort((e,n)=>{if(e.category===t.Cases&&n.category===t.Cases){const t=a(e.text)||e.text,s=a(n.text)||n.text;return t.localeCompare(s,"en",{sensitivity:"base"})}return e.normalizedText.localeCompare(n.normalizedText,"en",{sensitivity:"base"})})}function l(t){return t.replace(/([^.!?\n])\n([a-z])/g,"$1 $2").replace(/\n(at\s+\d)/g," $1").replace(/\n(v\.\s)/g," $1").replace(/\n(\d+\s+(?:U\.S\.|S\.Ct\.|F\.\d|L\.Ed))/g," $1").replace(/[ \t]+/g," ")}t.Cases,t.Statutes,t.Constitutional,t.Rules,t.Regulations,t.Treatises,t.Other,t.Cases,t.Statutes,t.Constitutional,t.Rules,t.Regulations,t.Treatises,t.Other;const u={[t.Cases]:1,[t.Statutes]:2,[t.Other]:3,[t.Rules]:4,[t.Regulations]:5,[t.Constitutional]:6,[t.Treatises]:7};function p(e,n){const s=function(t){return u[t]??3}(n);switch(n){case t.Cases:{const{longCite:t,shortCite:n}=function(t){let e=t.trim();e=e.replace(/^(?:See\s+(?:also\s+)?|Cf\.\s+|Accord\s+|But\s+see\s+)/i,"").trim(),e=e.replace(/(\d+)\s*(?:,\s*\d+(?:\s*[-â€“]\s*\d+)?)+(\s*\([^)]*\))/,"$1$2"),e=e.replace(/(\d+)\s*,\s*at\s+\d+(?:\s*[-â€“]\s*\d+)?(\s*\([^)]*\))/,"$1$2");let n="";const s=t.match(/([A-Z][A-Za-z.,' -]+?)\s+v\.\s+([A-Z][A-Za-z.,' -]+?)(?:,\s*\d|\s+\d)/);if(s){const t=s[2].trim(),e=t.split(/\s+/).filter(t=>/^[A-Z]/.test(t)&&!/^(?:Corp|Inc|Ltd|LLC|Co|v)\.?$/i.test(t));n=e.length>0?e[e.length-1].replace(/[.,]$/,""):t.split(/\s+/)[0]}if(!n){const e=t.match(/(?:In re|Ex parte)\s+([A-Z][A-Za-z'-]+)/i);e&&(n=e[0].trim())}if(!n){const t=e.match(/^([A-Z][A-Za-z'-]+)/);n=t?t[1]:e.substring(0,30)}return{longCite:e,shortCite:n}}(e);return{longCite:t,shortCite:n,categoryCode:s}}case t.Statutes:{const{longCite:t,shortCite:n}=function(t){let e=t.trim();return e=e.replace(/(Â§\s*[\d\w.-]+)\([^)]*\)(?:\([^)]*\))*/g,"$1"),{longCite:e,shortCite:e}}(e);return{longCite:t,shortCite:n,categoryCode:s}}default:{const t=e.replace(/^(?:See\s+(?:also\s+)?|Cf\.\s+)/i,"").trim();return{longCite:t,shortCite:t,categoryCode:s}}}}function g(t){return t.replace(/"/g,"â€")}function f(t,e,n){return`TA \\l "${g(t)}" \\s "${g(e)}" \\c ${n}`}var m=s(72),h=s.n(m),b=s(825),y=s.n(b),x=s(659),C=s.n(x),A=s(56),v=s.n(A),S=s(540),w=s.n(S),Z=s(113),z=s.n(Z),I=s(942),T={};T.styleTagTransform=z(),T.setAttributes=v(),T.insert=C().bind(null,"head"),T.domAPI=y(),T.insertStyleElement=w(),h()(I.A,T),I.A&&I.A.locals&&I.A.locals;let R=[],k=new Map,$=null,F=null;function E(t,e){const n=document.getElementById("status"),s=document.getElementById("statusMessage");n.className=`status ${e}`,s.textContent=t,n.classList.remove("hidden")}function L(t,e){const n=document.getElementById("progressContainer"),s=document.getElementById("progressBar"),o=document.getElementById("progressText");n.classList.remove("hidden"),s.style.width=`${t}%`,o.textContent=e}function B(){document.getElementById("progressContainer").classList.add("hidden")}function W(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}async function U(){try{L(0,"Reading documentâ€¦"),document.getElementById("scanButton").disabled=!0,await Word.run(async e=>{const n=e.document.body.paragraphs;n.load("text"),await e.sync(),L(30,"Detecting citationsâ€¦");const s=new Map;let a=1,u="";for(const t of n.items)u+=t.text+"\n",u.length>3e3&&(s.set(a++,u),u="");u&&s.set(a,u),L(60,"Deduplicatingâ€¦");const g=function(e,n,s={}){const a={includeFootnotes:!0,minConfidence:.7,customPatterns:[],...s},d=[...o,...a.customPatterns||[]],u=[];for(const[e,s]of n.entries()){const n=l(s);for(const s of d){const o=new RegExp(s.pattern.source,s.pattern.flags);let r;for(;null!==(r=o.exec(n));){let n=r[0].trim();if(s.category===t.Cases&&!s.isShortForm){n=n.replace(/^(?:See\s+also|See\s+e\.g\.|See|Cf\.|But\s+cf\.|Accord|Contra|But\s+see|E\.g\.,?)\s+/i,"");const t=n.search(/\bv\.\s+[A-Z]/);if(t>0){const e=n.slice(0,t).match(/([A-Z][\w.'&,\-]+(?: (?:[A-Z][\w.'&,\-]+|of|the|for|and|&|on|to))*)\s*$/);e&&(n=e[0].trimStart()+n.slice(t))}}u.push({text:n,category:s.category,startIndex:r.index,endIndex:r.index+r[0].length,pageNumber:e,isShortForm:s.isShortForm||!1})}}}const p=function(t){const e=[],n=new Map;for(const s of t){const t=i(s.text,s.category);if(n.has(t)){const o=e[n.get(t)],r=s.pages.filter(t=>!o.pages.includes(t));o.pages.push(...r),o.pages.sort((t,e)=>t-e),s.text.length>o.text.length&&(o.text=s.text,o.normalizedText=s.normalizedText)}else n.set(t,e.length),e.push({...s})}return e}(u.map(t=>({id:`cit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:t.text,originalText:t.text,normalizedText:r(t.text),category:t.category,pages:[t.pageNumber],isShortForm:t.isShortForm,isIncluded:!0})));for(const t of p)if(t.isShortForm){const e=c(t.text,p);e&&(t.parentCitationId=e)}return{citations:p,totalPages:n.size,fullText:e}}(Array.from(s.values()).join("\n"),s,{includeFootnotes:document.getElementById("includeFootnotes")?.checked??!0});R=g.citations,k.clear();for(const t of R)t.isShortForm||k.set(t.id,p(t.text,t.category));L(90,"Rendering UIâ€¦"),function(t){const e=document.getElementById("statsContent"),n=new Map;for(const e of t)e.isShortForm||n.set(e.category,(n.get(e.category)||0)+1);let s="";for(const[t,e]of n)s+=`<div class="stat-row"><span>${t}</span><span>${e}</span></div>`;s+=`<div class="stat-row total"><span><b>Total</b></span><span><b>${t.filter(t=>!t.isShortForm).length}</b></span></div>`,e.innerHTML=s,document.getElementById("stats").classList.remove("hidden")}(R),function(t){const e=document.getElementById("citationsContent"),n=function(t){return function(t){const e=new Map;for(const n of t)e.has(n.category)||e.set(n.category,[]),e.get(n.category).push(n);for(const[t,n]of e.entries())e.set(t,d(n));return e}(t)}(t);let s="";for(const[t,e]of n.entries()){const n=e.filter(t=>!t.isShortForm);if(n.length){s+=`<div class="cat-group"><div class="cat-title">${t} (${n.length})</div>`;for(const t of n){const e=k.get(t.id),n=e?e.longCite:t.text,o=e?e.shortCite:"";s+=`\n        <label class="cite-row">\n          <input type="checkbox" class="cite-cb"\n                 data-id="${t.id}" ${t.isIncluded?"checked":""} />\n          <div class="cite-body">\n            <div class="cite-long">${W(n)}</div>\n            <div class="cite-short">Short: <em>${W(o)}</em></div>\n            <div class="cite-pages">Pages: ${t.pages.join(", ")}</div>\n          </div>\n        </label>`}s+="</div>"}}e.innerHTML=s,e.querySelectorAll(".cite-cb").forEach(t=>{t.addEventListener("change",t=>{const e=t.target,n=R.find(t=>t.id===e.dataset.id);n&&(n.isIncluded=e.checked)})}),document.getElementById("citationsList").classList.remove("hidden")}(R),document.getElementById("markSection").classList.remove("hidden"),document.getElementById("idSection").classList.remove("hidden"),document.getElementById("generateSection").classList.remove("hidden"),B(),E(`Found ${R.filter(t=>!t.isShortForm).length} unique citations (${R.length} total incl. short forms).`,"success")})}catch(t){B(),E(`Scan error: ${t.message}`,"error")}finally{document.getElementById("scanButton").disabled=!1}}async function M(){try{const t=document.getElementById("markAllButton");t.disabled=!0,t.textContent="â³ Markingâ€¦";const e=R.filter(t=>t.isIncluded&&!t.isShortForm);if(!e.length)return void E("No citations selected.","error");if(!P())return void E("TA field marking requires Word Desktop. In Word Online, skip to Step 3 â€” the TOA will be generated with formatted text.","info");L(0,"Injecting TA fieldsâ€¦"),await Word.run(async t=>{for(let n=0;n<e.length;n++){const s=e[n],o=k.get(s.id);if(!o)continue;L(Math.round(n/e.length*90),`Marking ${n+1}/${e.length}: ${o.shortCite}`);const r=t.document.body.search(s.text,{matchCase:!1,matchWholeWord:!1});if(r.load("items"),await t.sync(),r.items.length>0){const e=r.items[0],n=f(o.longCite,o.shortCite,o.categoryCode);e.insertField(Word.InsertLocation.after,Word.FieldType.ta,n,!1),await t.sync(),$=o.shortCite,F=o.categoryCode,document.getElementById("lastMarkedCite").textContent=o.shortCite}}}),L(100,"Done!"),B(),E(`âœ… Marked ${e.length} citations with native TA fields.`,"success")}catch(t){B(),E(`Mark error: ${t.message}`,"error")}finally{const t=document.getElementById("markAllButton");t.disabled=!1,t.textContent="ðŸ“Œ 2. Mark All Citations (TA Fields)"}}async function O(){try{if(!P())return void E("Id. marking requires Word Desktop. In Word Online, skip to Step 3.","info");if(!$||null===F)return void E("No previous authority in session. Mark at least one citation first.","error");await Word.run(async t=>{const e=t.document.getSelection();if(e.load("text"),await t.sync(),!e.text||0===e.text.trim().length)return void E('Select an "Id." reference in the document first.',"error");const n=(s=F,`TA \\s "${g($)}" \\c ${s}`);var s;e.insertField(Word.InsertLocation.after,Word.FieldType.ta,n,!1),await t.sync(),E(`âœ… Marked "Id." â†’ grouped under "${$}" (cat ${F}).`,"success")})}catch(t){E(`Id. error: ${t.message}`,"error")}}function P(){try{return void 0!==Word.FieldType&&void 0!==Word.FieldType.toa}catch{return!1}}async function N(){try{const e=document.getElementById("generateButton");e.disabled=!0,e.textContent="â³ Generatingâ€¦",L(0,"Preparing TOAâ€¦");const n=R.filter(t=>t.isIncluded&&!t.isShortForm);if(!n.length)return B(),void E("No citations to include. Run Scan first.","error");const s=P();await Word.run(async e=>{L(10,"Inserting page breakâ€¦"),e.document.getSelection().insertBreak(Word.BreakType.page,Word.InsertLocation.before),await e.sync(),L(20,"Writing titleâ€¦");const o=e.document.getSelection().insertParagraph("TABLE OF AUTHORITIES",Word.InsertLocation.before);o.alignment=Word.Alignment.centered,o.font.bold=!0,o.font.size=14,o.font.name="Times New Roman",o.spaceAfter=12,await e.sync();const r=[{code:1,name:"CASES",category:t.Cases},{code:2,name:"STATUTES",category:t.Statutes},{code:6,name:"CONSTITUTIONAL PROVISIONS",category:t.Constitutional},{code:4,name:"RULES",category:t.Rules},{code:5,name:"REGULATIONS",category:t.Regulations},{code:7,name:"TREATISES",category:t.Treatises},{code:3,name:"OTHER AUTHORITIES",category:t.Other}],a=new Set(n.map(t=>t.category));let i=0;const c=r.filter(t=>a.has(t.category)).length;for(const o of r){if(!a.has(o.category))continue;i++,L(20+Math.round(i/c*70),`Writing ${o.name}â€¦`);const r=e.document.getSelection().insertParagraph(o.name,Word.InsertLocation.before);if(r.font.bold=!0,r.font.size=12,r.font.name="Times New Roman",r.font.underline=Word.UnderlineType.single,r.spaceBefore=12,r.spaceAfter=6,await e.sync(),s){const t=e.document.getSelection().insertParagraph("",Word.InsertLocation.before);t.font.name="Times New Roman",t.font.size=12,await e.sync();const n=`\\h \\c "${o.code}" \\p`;t.getRange(Word.RangeLocation.content).insertField(Word.InsertLocation.replace,Word.FieldType.toa,n,!1),await e.sync()}else{const s=n.filter(t=>t.category===o.category).sort((t,e)=>t.text.localeCompare(e.text));for(const n of s){const s=k.get(n.id),r=s?s.longCite:n.text,a=[...new Set(n.pages)].sort((t,e)=>t-e),i=a.length>=6?`${a.slice(0,6).join(", ")}, passim`:a.join(", "),c=72,d=r.length+i.length+2,l=`${r}${d<c?" "+".".repeat(Math.max(3,c-d))+" ":" ... "}${i}`,u=e.document.getSelection().insertParagraph(l,Word.InsertLocation.before);u.font.name="Times New Roman",u.font.size=12,u.font.bold=!1,o.category===t.Cases&&r.search(/,\s+\d/)>0&&u.getRange(Word.RangeLocation.whole),await e.sync()}}}L(95,"Finalizingâ€¦"),e.document.getSelection().insertParagraph("",Word.InsertLocation.before),await e.sync()}),L(100,"Done!"),B(),E(s?'âœ… TOA generated with native fields! Right-click â†’ "Update Field" to render page numbers.':"âœ… TOA generated! Page numbers are from the scan. For live page numbers, use Word Desktop.","success")}catch(t){B(),E(`TOA error: ${t.message}`,"error")}finally{const t=document.getElementById("generateButton");t.disabled=!1,t.textContent="ðŸ“„ 3. Generate TOA at Cursor"}}Office.onReady(t=>{t.host===Office.HostType.Word&&(document.getElementById("scanButton").addEventListener("click",U),document.getElementById("markAllButton").addEventListener("click",M),document.getElementById("markIdButton").addEventListener("click",O),document.getElementById("generateButton").addEventListener("click",N),E("Ready â€” click Scan to begin.","info"))})})();